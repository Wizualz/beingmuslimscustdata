<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Customer Form - fallback (form POST)</title>
<style>
  body{font-family:Arial;background:#f5f7fb;padding:24px}
  .card{max-width:520px;margin:24px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 6px 20px rgba(16,24,40,.06)}
  input, select{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #e6eef6;box-sizing:border-box}
  button{margin-top:12px;width:100%;padding:12px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-weight:700}
  .msg{margin-top:12px;font-weight:600}
  .success{color:#059669} .error{color:#dc2626}
</style>
</head>
<body>
  <div class="card">
    <h2>Customer Details</h2>
    <form id="theForm" method="POST" action="https://script.google.com/macros/s/AKfycbxPCvWE1Rp5CeBWLCoTrA_7qGyn0pkx2tpi1ztjuXdbJkINyb1vNu1pFzMMC0WArCma-A/exec" target="hidden_iframe">
      <label>Name</label>
      <input name="name" id="name" type="text" required placeholder="Full name" />
      <label>Phone</label>
      <input name="phone" id="phone" type="tel" required placeholder="9876543210" />
      <label>Branch</label>
      <select name="branch" id="branch">
        <option value="">-- Select branch --</option>
        <option>MUMBAI</option><option>DELHI</option><option>SURAT</option><option>PUNE</option>
        <option>AHMEDABAD</option><option>AURANGABAD</option><option>BELGAUM</option><option>HYDERABAD</option>
        <option>LUCKNOW</option><option>BHOPAL</option>
      </select>

      <input type="hidden" id="branchHidden" name="branch" />
      <button type="submit">Save</button>
    </form>

    <div id="msg" class="msg" role="status" aria-live="polite"></div>
    <p style="font-size:13px;color:#64748b;margin-top:8px">Tip: use ?branch=MUMBAI in URL to auto-fill branch.</p>
  </div>

  <!-- hidden iframe to receive response so page doesn't redirect -->
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

<script>
(function(){
  const params = new URLSearchParams(window.location.search);
  const branchParam = (params.get('branch') || '').trim();
  const branchSelect = document.getElementById('branch');
  const branchHidden = document.getElementById('branchHidden');
  const msg = document.getElementById('msg');

  // if URL param present, set hidden field and disable select
  if(branchParam){
    branchHidden.value = branchParam;
    // try select matching option if exists
    for(const opt of branchSelect.options){
      if(opt.value && opt.value.toLowerCase() === branchParam.toLowerCase()){
        opt.selected = true; break;
      }
    }
    branchSelect.disabled = true;
  } else {
    // if not passed, copy select value into hidden before submit
    branchSelect.addEventListener('change', () => branchHidden.value = branchSelect.value);
  }

  // set hidden on load in case select default
  branchHidden.value = branchSelect.value;

  // when iframe loads after submit, show success (we can't read body due cross-origin)
  const iframe = document.getElementById('hidden_iframe');
  iframe.addEventListener('load', function(){
    // small delay to allow server response to finish
    setTimeout(()=> {
      msg.textContent = 'Submission received â€” check Google Sheet.'; 
      msg.className = 'msg success';
    }, 150);
  });

  // show error if form fields invalid
  document.getElementById('theForm').addEventListener('submit', function(e){
    msg.textContent = ''; msg.className = 'msg';
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    if(!name || !phone){
      e.preventDefault();
      msg.textContent = 'Please fill name and phone.'; msg.className = 'msg error';
      return false;
    }
    // set hidden branch from select (in case)
    branchHidden.value = branchSelect.value;
    // allow submit to proceed
  });
})();
</script>
</body>
</html>



